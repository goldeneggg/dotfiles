# Basic settings

## オブジェクト セレクタ
オブジェクト セレクタは

- それ単体で指定したら「移動」
- 挿入モードへの移行コマンドと組み合わせた場合、`aセレクタ` は前or後の空白を含む、`iセレクタ`は含まない
  - `caセレクタ` は空白含めた部分を置換、`ciセレクタ`は含めない部分を置換
  - `daセレクタ` は空白含めた部分を削除、`diセレクタ`は含めない部分を削除

### 単語
`e`, `E` 後方は`b`, `B`（単語自体）

`w`, `aw`, `iw` 後方は `ge`, `gE`（単語の前or後）

`W`, `aW`, `iW`

`w`(`b`)と`W`(`B`)の違いは、`w`が英単語、`W`が空白以外の文字も含めたまとまり（例えば`aa.bb.cc`は`w`だと5単語だが`W`だと1単語）

### 文
`as`, `is`

### 段落
`ap`, `ip`

### カッコ `()`
`ab`, `ib`、もしくは記号自体

### 波カッコ `{}`
`aB`, `iB`、もしくは記号自体

### その他、囲むもの系
`a記号自体`, `i記号自体`

`"` とか `<` とか色々


## 割りと忘れるコマンド

### 削除
[VIM達人への道　超削除](http://vimmer.blog5.fc2.com/blog-entry-16.html)

- `db` - （カーソルが単語の先頭にあるとき）前の単語を削除 
- `d0` - カーソルの前から行の先頭までを削除 
- `diw`- 単語を削除（スペースは削除しない）
- `daw` - 単語を削除
- `dip`- 段落（かたまり）削除 
- `dap` - 段落とその後の空行を削除 
- `dvip` - 段落の最後の行を残し削除 
- `D` - カーソルから行の最後まで削除

### 豪快に飛びたい
- `gg` - ファイルの先頭に移動
- `G` - ファイルの末尾に移動

### 画面上の何処かに飛びたい
- `H` - 画面最上行に移動
- `M` - 画面中央行に移動
- `L` - 画面最下行に移動

### 文移動
- `(` - 文を前へ移動
- `)` - 文を後へ移動

### 段落移動
- `{` - 段落を前へ移動
- `}` - 段落を後へ移動

### カーソル位置基準で画面をスクロール
- `z <Enter>` - カーソル行を画面最上部にスクロール
- `z.` - カーソル行を画面中央部にスクロール
- `z-` - カーソル行を画面最下部にスクロール

### 行結合
- `J` - 下の行を現在行末尾に結合。インデントはスペースに置換
- `gJ` - 下の行を現在行末尾に結合。インデント置換しない
- ビジュアルモードで`J` - 選択している行を1行に結合


### redo,undo
- `.` - 直前のコマンドを繰り返し
- `C-r` - Redo
- `u` - Undo

### インサートモードへの移行
- `I` - カーソル行の先頭でインサートモードへ
- `A` - カーソル行の末尾でインサートモードへ
- `O` - カーソル行の上に1行開けてインサートモードへ


### ビジュアルモード
- `C-v` - 矩形ビジュアルモード選択
  - `I` - 矩形選択箇所の左端にテキスト挿入
  - `A` - 矩形選択箇所の右端にテキスト挿入
  - `r` - 矩形選択箇所の文字列を一括置換
  - `<`, `>` - 矩形シフト

### コードの整形（インデント揃え）
- `=` - 整形
  - `=G` - 末尾まで実行
  - `gg=G` - ファイル全体を整形（`gg` で先頭に移動、`=G` で末尾まで実行）

### ウインドウ関連
- `:new` - 新規ウインドウ作成（垂直）
- `:vnew` - 新規ウインドウ作成（水平）
- ウインドウ間の移動
  - `C-w w` - 次のウインドウに移動
  - `C-w h` - 左のウインドウに移動
  - `C-w j` - 下のウインドウに移動
  - `C-w k` - 上のウインドウに移動
  - `C-w l` - 右のウインドウに移動
- 分割したウインドウの位置そのものを動かす
  - `C-w H` - 左のウインドウに移動
  - `C-w J` - 下のウインドウに移動
  - `C-w K` - 上のウインドウに移動
  - `C-w L` - 右のウインドウに移動
  - `C-w r` - 回転
- ウインドウの大きさを変える
  - `C-w _` - 縦に最大化
  - `C-w |` - 横に最大化
  - `C-w =` - 大きさを揃える
  - `C-w >` - 幅を増やす
  - `C-w <` - 幅を減らす
  - `C-w +` - 高さを増やす
  - `C-w -` - 高さを減らす

### バッファ関連
- `:ls` - バッファ一覧を表示
- `:b [num]` - 指定したバッファ番号のバッファをウインドウに表示
- `:bd [num]` - 指定したバッファ番号のバッファを削除, 実際は、バッファは完全に削除されていない
- `:bw [num]` - 指定したバッファ番号のバッファを削除, このバッファに関するすべてが失われる
- `:bn` - 次のバッファに移動
- `:bp` - 前のバッファに移動

### タブ関連
__ウインドウのまとまりをグループ化したものがタブ__

- `:tabnew` - 新規タブ
- `gt` - 次のタブに切り替え
- `gT` - 前のタブに切り替え

### ファイル編集
http://d.hatena.ne.jp/Minamo/20081126/1227721180

- `:e C-d` - ファイル一覧から選択して開く
- `:r[ead]` - ファイルを読み込む
  - `:0r[ead]` - 行頭に読み込む。`0`は行頭へのジャンプを意味する
- `gf` - カーソル上のパラグラフがファイルパスを示していたら、そのファイルを開く
  - `gF LINENUM` - `gf`の行指定版

#### ファイルパス
- `%` - 今開いているファイルのパスに置換される
  - `:w %.txt` - 今開いているファイル名.txt で保存する
- `%<` - 今開いているファイルのパスから拡張子を省いた文字列に置換される
- `%:h` - 今開いているファイルのディレクトリのパス
- `%:t` - 今開いているファイルのファイル名
- `%:t:r` - 今開いているファイルのファイル名（拡張子なし）


### レジスタ
__aからzまでの26種類のアルファベットで名前を付けて内容を保存できるクリップボード のようなもの__

- `"ay` - 選択範囲をレジスタaに保存
- `"ayy` - 今いる行をレジスタaに保存
- `"ap` - レジスタaの内容をカーソル位置にペースト
- `:reg` - レジスタに格納されている情報を一覧表示

### マクロ, 操作記憶
__特定の操作を文字列として記憶し、再生する機能。記憶した操作は文字列としてレジスタに記憶される__

- `qa` - レジスタaに操作を記録開始
- `q` - 記録中ならその記録を終了
- `@a` - レジスタaに記録した操作を再実行する
- `:%norm! @a` - ファイル全体に対してレジスタaに記録した操作を適用する

### マーク
__aからzまでの26種類のアルファベットで名前を付けてカーソル位置を記憶できる機能__

- `ma` - 現在のカーソル位置をマークaに保存
- `'a` - マークaの位置に移動
- `:marks` - マーク一覧を表示

- 検索やジャンプを実行した場合、内部的にはマークと同じ事が行われてて、 __移動の履歴が記憶されているのでその履歴を相互に行き来することが出来る__
  - `C-o` - 1つ古いマークへジャンプ
  - `C-i` - 1つ新しいマークへジャンプ


### ファイルエクスプローラ (Netrwプラグイン)
- `:e`とか`:sp`等で __ディレクトリを指定して開く__ とファイルエクスプローラ起動

#### キー操作
- `<Enter>` - カーソル下のファイル/ディレクトリを開く
- `o` - カーソル下のファイル/ディレクトリを別ウインドウで開く
- `p` - カーソル下のファイル/ディレクトリをプレビューウインドウで開く
- `t` - カーソル下のファイル/ディレクトリを別タブで開く

- `-` - 1つ上のディレクトリに移動
- `c` - 今いるディレクトリをカレントに指定
- `i` - 表示形式を切り替え（更新日時を表示したりetc）
- `s` - （詳細表示時に）カーソルがある行でソート

#### ディレクトリブックマーク
- `mb` - カレントディレクトリをブックマークする
- `mB` - ブックマークを削除する
- `{number}mB` - 指定した番号のブックマークを削除する
- `qb` - ブックマーク一覧を表示する
- `gb` - 最後にブックマークしたディレクトリへ移動する
- `{number}gB` - 指定した番号のブックマークへ移動する

#### ファイルマーク
- `mf` - 選択中のファイルをマークする/マーク済ならマークを解除する
- `mr` - ワイルドカード指定で複数ファイルをマークする
- `mu` - 全てのマークを解除する
- `me` - マークしたファイルを一括で開く

### コマンドモードでの色々 (`: hogehoge`)
- `%` - コマンドモードにおいての`%`は、 __アクティブバッファのファイルパス、つまりファイル全体__ として使用可能
  - `:%...` - ファイル全体に対して `...` する
  - `:save %<TAB>` - ファイルパスをTABで展開して、一部をいじって別名保存
- `:paste/nopaste` - PASTEモードへ移行する
- `:a!` - インデントを含んだテキストをクリップボードからペーストしたい時、インデント崩れを抑止する。対象テキストをペーストした後`.`を入力して終了させればOK
- `:h [機能名/プラグイン名]` - 対象のヘルプを表示
- `:map [パターン]` - パターンで始まるキーバインドが何にmappingされているか調べるのが:mapコマンド
  - `:verbose map [パターン]` - mapの出力を詳細にする
- `:highlight` - ハイライト色設定の確認
- `:so $VIMRUNTIME/syntax/colortest.vim` - 色設定のテスト

## `autocmd`
autocommandとは、vim内でイベントが発生した時にあらかじめ登録しておいたコマンドを実行する機能である

- 書式 = `au[tocmd] [group] EVENT PATTERN [nested] CMD`
- `:h event` でイベント一覧をヘルプで確認できる

### EVENT
- `FileType` - `filetype` オプションが設定された時に発生するイベント
  - PATTERN - ファイルタイプを指定(`vim`, `ruby` etc)

## キーマップ keymap
http://vim-jp.org/vimdoc-ja/map.html

`map {lhs} {rhs}` で `{lhs}` を `{rhs}` に割り当てる

### `map` と `noremap` と `unmap`
例えば`nmap`と`nnoremap`は何が違うのか？

- `map` - マップが使用されたときに {rhs} が調べられ、再マップされる
  - マップを入れ子にしたり再帰的にすることができる
- `noremap`は文字通り再マップしない。マップが入れ子になったり再帰的になることはない。
  - コマンドを再定義するときによく使われます。
- `unmap` はマップを削除する

### モード

```
マップコマンドとモードの対応表。詳細は以後に。
     コマンド                    モード
:map   :noremap  :unmap     ノーマル、ビジュアル、選択、オペレータ待機
:nmap  :nnoremap :nunmap    ノーマル
:vmap  :vnoremap :vunmap    ビジュアル、選択
:smap  :snoremap :sunmap    選択
:xmap  :xnoremap :xunmap    ビジュアル
:omap  :onoremap :ounmap    オペレータ待機
:map!  :noremap! :unmap!    挿入、コマンドライン
:imap  :inoremap :iunmap    挿入
:lmap  :lnoremap :lunmap    挿入、コマンドライン、Lang-Arg
:cmap  :cnoremap :cunmap    コマンドライン
```

### 特別な引数
- `<buffer>` - カレントバッファだけで使用されるマップを作成
- `<silent>` - 実行するコマンドがコマンドラインに表示されないようにする
- `<expr>` 引数が式 (スクリプト) として扱われる。マップが実行されたときに、式が評価され、その値が {rhs}として使われる
  - 例: `inoremap <expr> . InsertDot()` - InsertDot() 関数の戻り値が挿入される

### 特殊文字
- `<Nop>` - 空のマップ（何もしない）（`:map  <F8>  <Nop>` - `F8` を押しても何もしない）
- `<Space>` - 空白文字
- `<Leader>` - その部分が変数 `mapleader` に設定された文字列で置き換わる
  - デフォルトは `\`（バックスラッシュ）
- `<LocalLeader>` - その部分が変数 `maplocalleader` に設定された文字列で置き換わる
  - グローバルプラグインでは `<Leader>` を使用し、ファイルタイププラグインでは `<LocalLeader` を使用するといい
- `<Plug>` - スクリプトの内部作業用のマップを定義。これはどのキー入力にもマッチしない
  - プラグインを作成するときに便利

## ctags連携

### コマンド
[Browsing programs with tags - Vim Tips Wiki - Wikia](http://vim.wikia.com/wiki/Browsing_programs_with_tags)

- `C-]` - カーソル上のワードと同じタグ名のタグへジャンプ
  - `C-w ]` - 分割ウインドウを開いてジャンプ
- `:ta[g] TAGNAME` - 指定タグ名のタグへジャンプ
  - `:sta[g] TAGNAME` - 分割ウインドウを開いてジャンプ
- `g]`, `tag-matchlist`, `:tse[lect]` - カーソル上のワードと同じタグ名の複数のタグ候補から選択してジャンプ
  - `stse[lect]` - 分割ウインドウを開いてジャンプ
- `C-t`, `:pop` - ジャンプのスタックを一つ戻る,
  - __普段tmuxを`C-t`で使ってるからバッティングをどうにかしたい__ => `pop` を別キーにmapすればよい
  - `C-[` にバインドする => `nmap <C-[>  :pop<CR>`
- `:[count]ta` - タグスタックのcount分だけ新しいエントリにジャンプする
- `:[count]po` - タグスタックのcount分だけ古いエントリにジャンプする
- `:tags` - タグスタックの内容を表示する
- `:ts[ident]` - ident(識別子) にマッチするタグをリスト表示する, idenxを`/`で始めると正規表現が使える, `:ts TAB`といった具合に入力途中に候補をタブ補完表示させることも可能
- `:sts[ident]` - `:ts`のウインドウ分割版

## 小技
- 置換の際に改行を入れる - `Ctrl-v` `Ctrl-m`でCRコードを入力すればOK

# プラグイン

## `.vimrc.golang` using vim-go

- `]]` : 次の関数へジャンプ
- `[[` : 前の関数へジャンプ

- `:GoDeclsDir` : パッケージ内の関数や型の定義元一覧, ctrlpで表示

