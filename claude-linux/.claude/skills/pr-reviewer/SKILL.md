---
name: pr-reviewer
description: Review code changes in GitHub pull requests or local git branches against main branch. This skill should be used when users request code review for PRs or branch changes in git repositories.
---

# pr-reviewer

Git/GitHubを用いたアプリケーション開発における包括的なコードレビューを実施し、コード品質、セキュリティ、ベストプラクティスに焦点を当てます。

**注意: このSkillを使用する際のユーザーとのやり取りはすべて日本語で行います。**

## このSkillを使用するタイミング

以下の場合にこのSkillを使用します：

- ユーザーがリポジトリとPR番号を指定してGitHub PRのレビューを依頼した場合
- ユーザーがローカルブランチの変更をmainブランチと比較したレビューを依頼した場合
- ユーザーが最近の変更に対するコード品質評価を求めた場合
- ユーザーがコーディング規約への準拠についてフィードバックを必要としている場合

## 目的

git管理されたリポジトリに対して徹底的なコードレビューを実施し、潜在的な問題の特定、改善提案、クラウドアプリケーション開発のコーディング規約とベストプラクティスへの準拠を確認します。

## レビュープロセス

### 1. コード変更とコンテキストの取得

レビュー対象に応じて適切なdiffスクリプトを実行します：

**GitHub PRレビューの場合：**

```bash
~/.claude/skills/pr-reviewer/scripts/diff.sh --repo {repo} --pr {pr_num}
```

- `{repo}`: "owner/name" 形式のリポジトリ（例: "goldeneggg/biz"）
- `{pr_num}`: プルリクエスト番号

また、コンテキストを理解するためにPRの説明を取得します：

```bash
gh pr view {pr_num} --repo {repo} --json title,body --jq '.title + "\n\n" + .body'
```

**ローカルブランチレビューの場合：**

```bash
~/.claude/skills/pr-reviewer/scripts/diff.sh --branch {target_branch} --base {base_branch}
```

- `{target_branch}`: レビュー対象のブランチ（例: "fix-ai"）
- `{base_branch}`: 比較元のベースブランチ（デフォルト: "main"）

**オプションのoutlineパラメータ：**

- `{outline}`: ユーザーが提供する変更の概要やコンテキスト
- ユーザーから提供された場合、これを変更内容を理解するための主要なコンテキストとして使用
- PRレビューで提供されない場合、上記で取得したPRの説明を使用
- ブランチレビューで提供されない場合、diff自体からコンテキストを推測

### 2. 変更内容の理解

- **まず**、outline/コンテキストを読みます：
  - PRレビューの場合: `{outline}` が提供されていればそれを使用、なければPRの説明を使用
  - ブランチレビューの場合: `{outline}` が提供されていればそれを使用、なければdiffから推測

- **次に**、diff出力を分析して、どのコードが変更・追加・削除されたかを理解
- コンテキストと実際のコード変更の両方に基づいて、変更の範囲と目的を特定
- 言語固有の規約についてはプロジェクトドキュメント（CLAUDE.md）のコンテキストを考慮

### 3. レビューの実施

以下の観点で変更を検証します：

**コード品質：**

- 変更が新しいバグや問題を導入していないか確認
- 適切なエラーハンドリングパターンをチェック
- コードの可読性と保守性を評価
- 命名規則とコード構成を検証

**コーディング規約：**

- CLAUDE.mdのプロジェクト固有のコーディング規約への準拠を確認
- 適切なコードフォーマットと構造を検証
- インポート順序をチェック（stdlib → external → internal）
- テストカバレッジとテストパターンを検証

**セキュリティ：**

- 潜在的なセキュリティ脆弱性を特定
- ハードコードされた秘密情報や認証情報をチェック
- 適切な入力バリデーションを検証
- セキュリティクリティカルな操作での暗号ライブラリの適切な使用を確認

**ベストプラクティス：**

- 言語固有のベストプラクティスへの準拠を評価
- 適切な並行処理パターンをチェック（該当する場合）
- 適切なエラーハンドリングとロギングを検証
- リソース管理とクリーンアップを検証

**追加の考慮事項：**

- 必要に応じてMCPツール（fetch、context7）を使用して外部ソースから最新の公式仕様とベストプラクティスを収集
- Go 1.25+コードベースのプロジェクト固有のガイドラインはCLAUDE.mdを参照

### 4. フィードバックの提供

フィードバックは以下の構造で日本語で提供します：

**問題点（優先度別）:**

- 内容: 具体的な問題の説明
- 期待される内容や動作との差異: 現状と期待される動作のギャップ
- 根拠となる文献: 参考文献（該当する場合）

**改善点（優先度別）:**

- 内容: 改善提案
- 具体的な改善方法: 具体的な改善アプローチ

**その他の報告事項（もしあれば）:**

- 追加の観察事項や推奨事項

## ガイドライン

- **重要: ユーザーとのすべてのコミュニケーションは日本語で行う必要があります** - 質問、フィードバック、説明、その他すべてのやり取り
- 必要に応じてMCPツール（fetch、context7、WebFetch、WebSearch）を使用して外部ソースから最新の公式仕様とベストプラクティスを収集
- 不明点は必ずユーザーに確認してから進める
- レビュータスクは徹底的かつ粘り強く完了させる
- 開発者がコード品質を向上させるのに役立つ実用的なフィードバックに焦点を当てる
